<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog 
 xmlns="http://www.liquibase.org/xml/ns/dbchangelog" 
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
 xmlns:n0="http://www.oracle.com/xml/ns/dbchangelog-ext" 
 xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog 
 http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">
 <changeSet id="19720564b4a8494a9c80c08cbffbcad3b7240512" author="(WKSP_OACLABWS)-Generated" failOnError="true"    runOnChange="false"  runAlways="false"  runInTransaction="false"  >
  <n0:createOraclePackageBody objectName="WF_CUSTOM_LOGIN" objectType="PACKAGE_BODY" ownerName="WKSP_OACLABWS"  replaceIfExists="false" >
    <n0:source><![CDATA[CREATE OR REPLACE EDITIONABLE PACKAGE BODY "%USER_NAME%"."WF_CUSTOM_LOGIN" AS 

FUNCTION WF_login(p_username IN VARCHAR2, p_password IN VARCHAR2) 
RETURN BOOLEAN 
IS
    v_count NUMBER; 
    l_password  WF_EMPLOYEE_DET.LOGIN_PASSWORD%type;
BEGIN  
	--Check whether user exists with username or not.. if exists match password and Return TRUE else Return FALSE
    SELECT count(*) into v_count  
    FROM WF_EMPLOYEE_DET
    WHERE TRIM(UPPER(ENAME)) = TRIM(UPPER(p_username));
            
    IF v_count >= 1 THEN       
        
        select LOGIN_PASSWORD--WF_ENC_DEC.decrypt_pwd(password)
        into l_password 
        FROM WF_EMPLOYEE_DET  
        WHERE TRIM(UPPER(ENAME)) = TRIM(UPPER(p_username));
  
        -- Compare the two, and if there is a match, Return TRUE else Return FALSE
        IF p_password = l_password THEN
            APEX_UTIL.SET_AUTHENTICATION_RESULT(0);
            RETURN true;
        ELSE
            APEX_UTIL.SET_AUTHENTICATION_RESULT(4);
            RETURN false;
        END IF;
    ELSE 
        RETURN FALSE; 
    END IF; 
END WF_login; 
 
END WF_CUSTOM_LOGIN;
/]]></n0:source>
      </n0:createOraclePackageBody>
 </changeSet>
</databaseChangeLog>
